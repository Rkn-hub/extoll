// COPY THIS ENTIRE CODE TO YOUR GOOGLE APPS SCRIPT
// IMPORTANT: After pasting, click Deploy → Manage deployments → Edit → New version → Deploy

function doPost(e) {
  try {
    // Your spreadsheet ID
    var spreadsheetId = "1QignXZqzzBlr2qQolWA7jZr78FGebvzbZPUI7-gQbSA";
    var sheet = SpreadsheetApp.openById(spreadsheetId).getSheets()[0];
    
    // Get form data from POST request
    var fullName = e.parameter.fullName || e.parameters.fullName || '';
    var email = e.parameter.email || e.parameters.email || '';
    var phone = e.parameter.phone || e.parameters.phone || '';
    var message = e.parameter.message || e.parameters.message || '';
    var timestamp = new Date();
    
    // Log for debugging
    Logger.log('Received: ' + fullName + ', ' + email + ', ' + phone + ', ' + message);
    
    // Add to spreadsheet
    sheet.appendRow([timestamp, fullName, email, phone, message]);
    
    // Return success with CORS headers
    return ContentService
      .createTextOutput(JSON.stringify({
        'result': 'success',
        'message': 'Data saved successfully'
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    Logger.log('Error: ' + error.toString());
    return ContentService
      .createTextOutput(JSON.stringify({
        'result': 'error',
        'error': error.toString()
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

function doGet(e) {
  return ContentService
    .createTextOutput("Google Apps Script is working! Use POST to submit data.")
    .setMimeType(ContentService.MimeType.TEXT);
}
